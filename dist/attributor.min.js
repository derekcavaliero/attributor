/*! 
 * attributor.js v2.1.1 
 * https://github.com/derekcavaliero/attributor
 * Â© 2018-2024 Derek Cavaliero @ LEVEL
 * Updated: 2024-11-13 10:41:56 PST 
 */
Attributor=function(a){var b={cookieDomain:location.hostname,cookieNames:{first:"attr_first",last:"attr_last"},decorateHostnames:[],enableSpaSupport:!1,fieldMap:{first:{source:"utm_source_1st",medium:"utm_medium_1st",campaign:"utm_campaign_1st",term:"utm_term_1st",content:"utm_content_1st",source_platform:"utm_source_platform_1st",marketing_tactic:"utm_marketing_tactic_1st",creative_format:"utm_creative_format_1st",id:"utm_id_1st",adextension:"utm_adextension_1st",adgroup:"utm_adgroup_1st",adgroupid:"utm_adgroupid_1st",adplacement:"utm_adplacement_1st",adposition:"utm_adposition_1st",campaignid:"utm_campaignid_1st",geo:"utm_geo_1st",keymatch:"utm_keymatch_1st",device:"utm_device_1st",matchtype:"utm_matchtype_1st",network:"utm_network_1st"},last:{source:"utm_source",medium:"utm_medium",campaign:"utm_campaign",id:"utm_id",term:"utm_term",content:"utm_content",source_platform:"utm_source_platform",marketing_tactic:"utm_marketing_tactic",creative_format:"utm_creative_format",adextension:"utm_adextension",adgroup:"utm_adgroup",adgroupid:"utm_adgroupid",adplacement:"utm_adplacement",adposition:"utm_adposition",campaignid:"utm_campaignid",geo:"utm_geo",keymatch:"utm_keymatch",device:"utm_device",matchtype:"utm_matchtype",network:"utm_network"},cookies:null,globals:null},fieldDataAttribute:"data-attributor-field",fieldTargetMethod:["name"],filters:{},nullValue:"(not set)",sessionTimeout:30};console.time("Attributor.js"),a.fieldTargetMethod=Array.isArray(a.fieldTargetMethod)?a.fieldTargetMethod:[a.fieldTargetMethod],this.config=this.deepMerge(b,a),this.referrer=this.setReferrer(),this.parameters=this.setParameters(),this.session={first:this.getCookie(this.config.cookieNames.first)||!1,last:this.getCookie(this.config.cookieNames.last)||!1},this.updateSession(),this.fillFormFields(),this.setEventListeners(),console.timeEnd("Attributor.js")},Attributor.prototype={deepMerge:function(a,b){for(var c in b)b.hasOwnProperty(c)&&b[c]instanceof Object&&Object.assign(b[c],this.deepMerge(a[c],b[c]));return Object.assign(a||{},b),a},grab:function(a){var a="undefined"!=typeof a?a:"all",b={cookies:this.getCookieValues(),globals:this.getGlobalValues()};for(var c in this.config.fieldMap)if(this.config.fieldMap.hasOwnProperty(c)&&b.hasOwnProperty(c))for(var d in this.config.fieldMap[c])this.config.fieldMap[c].hasOwnProperty(d)&&(b[c][d]&&b[c][d]!=this.config.nullValue&&(b[c][this.config.fieldMap[c][d]]=b[c][d]),delete b[c][d]);var e={};return"all"==a?e=this.session:["first","last"].indexOf(a)>-1&&(e=this.session[a]),Object.assign({session:e},b.cookies,b.globals)},fillFormFields:function(a){var b=this,a="object"==typeof a?a:{};a.hasOwnProperty("targetMethod")&&(a.targetMethod=Array.isArray(a.targetMethod)?a.targetMethod:[a.targetMethod]);var c={targetMethod:a.targetMethod||this.config.fieldTargetMethod,scope:a.scope||document},d={_params:this.params,first:this.session.first,last:this.session.last,cookies:this.getCookieValues(),globals:this.getGlobalValues()};for(var e in this.config.fieldMap)if(this.config.fieldMap.hasOwnProperty(e))for(var f in this.config.fieldMap[e])if(this.config.fieldMap[e].hasOwnProperty(f)){var g,h=this.config.fieldMap[e][f],i=[];if(c.targetMethod.forEach(function(a){var c={"class":"input."+h,parentClass:"."+h+" input",dataAttribute:"input["+b.config.fieldDataAttribute+'="'+h+'"]',name:'input[name="'+h+'"]'};i.push(c[a]||c.name)}),g=c.scope.querySelectorAll(i.join(",")))for(var j=0;j<g.length;j++)d[e].hasOwnProperty(f)&&""!=d[e][f]&&(g[j].value=d[e][f],g[j].dispatchEvent(new Event("input",{bubbles:!0})))}},getCookie:function(a,b){var b="undefined"==typeof b||b,c="";if(document.cookie.length>0){var d=document.cookie.indexOf(a+"=");if(d!=-1){d=d+a.length+1;var e=document.cookie.indexOf(";",d);e==-1&&(e=document.cookie.length),c=document.cookie.substring(d,e),b&&(c=JSON.parse(decodeURIComponent(c)))}}return c},getCookieValues:function(){var a={};for(var b in this.config.fieldMap.cookies)this.config.fieldMap.cookies.hasOwnProperty(b)&&(a[b]="function"==typeof this.config.filters[b]?this.config.filters[b](this.getCookie(b,!1)):this.getCookie(b,!1));return a},getGlobalValues:function(){var a={};for(var b in this.config.fieldMap.globals)if(this.config.fieldMap.globals.hasOwnProperty(b))try{a[b]="function"==typeof this.config.filters[b]?this.config.filters[b](this.resolve(b)):this.resolve(b)}catch(c){}return a},monkeyPatchHistory:function(){console.warn("Attributor.js: config.enableSpaSupport = true monkeypatches the the history.pushState() method.");var a=history.pushState;history.pushState=function(b){return"function"==typeof history.onpushstate&&history.onpushstate({state:b}),a.apply(history,arguments)}},parseParameters:function(){var a=this,b={};if(!this.parameters)return b;var c=Object.keys(this.config.fieldMap.last);if(c.forEach(function(c){var d="utm_"+c;a.parameters.has(d)&&(b[c]=a.parameters.get(d))}),!this.parameters.has("utm_source")&&!this.parameters.has("utm_medium")){var d={google:["gclid","gclsrc","dclid","wbraid","gbraid","gad_source"],facebook:"fbclid",bing:"msclkid",linkedin:"li_fat_id",tiktok:"ttclid",twitter:"twclid"},e=!1;for(var f in d)if(d.hasOwnProperty(f)){var g=d[f];if(Array.isArray(g)){for(var h=0;h<g.length;h++)if(this.parameters.has(g[h])){e=!0;break}}else this.parameters.has(g)&&(e=!0);if(e){b.source=f,b.medium="cpc";break}}}return b},parseReferrer:function(a){var b=a?new URL(a):this.referrer,c={};if(!b||b.hostname.indexOf(this.config.cookieDomain)>-1)return c;c={source:b.hostname,medium:"referral"};var d={organic:{google:"^www.(google).[a-z]{2,3}(?:.[a-z]{2})?$",bing:"^www.(bing).com$",duckduckgo:"^(duckduckgo).com$",yahoo:"^(?:www|m)?.?(yahoo).(?:com|cn)$",ecosia:"^www.(ecosia).org$",ask:"^www.(ask).com$",aol:"^(?:search.)?(aol).com$",baidu:"^www.(baidu).com$",xfinity:"^my|search.(xfinity).com",yandex:"^(?:www.)?(yandex).com|ru$",lycos:"^(?:www|search)?.?(lycos).[a-z]{2,3}(?:.[a-z]{2})?$"},social:{linkedin:"^www.(linkedin).com$",facebook:"^www.(facebook).com$",twitter:"^t.co$",instagram:"^l.(instagram).com$"}};for(var e in d)if(d.hasOwnProperty(e)){for(var f in d[e])if(d[e].hasOwnProperty(f)){var g=b.hostname.match(d[e][f]);if(g){c.source=f,c.medium=e;break}}if(Object.keys(d).indexOf(c.medium)>-1)break}return c},resolve:function(a){return a.split(".").reduce(function(a,b){return a?a[b]:null},window)},setCookie:function(a,b,c,d){var d="undefined"!=typeof d?d:"minutes",e=new Date;"days"==d&&e.setDate(e.getDate()+c),"minutes"==d&&e.setTime(e.getTime()+60*c*1e3),document.cookie=a+"="+encodeURIComponent(JSON.stringify(b))+(null==c?"":"; domain=."+this.config.cookieDomain+"; expires="+e.toUTCString())+"; path=/"},setEventListeners:function(){function a(a){a.target.matches('[type="submit"]')&&c.fillFormFields({scope:a.target.form||a.target.closest("form")})}function b(a){if(a.target.matches("a")&&a.target.href){var b=new URL(a.target.href);if(c.config.decorateHostnames.indexOf(b.hostname)!==-1){var d=Object.keys(c.config.fieldMap.last);d.forEach(function(a){c.session.last[a]!==c.config.nullValue&&b.searchParams.set("utm_"+a,c.session.last[a])}),a.target.href=b.toString()}}}var c=this;if(this.config.enableSpaSupport){this.monkeyPatchHistory();var d=function(a){c.setReferrer(!0),c.updateSession()};window.addEventListener("popstate",d),window.onpopstate=history.onpushstate=d}document.addEventListener("click",a),document.addEventListener("click",b)},setParameters:function(){var a=new URL(location.href);return!!a.search&&a.searchParams},setReferrer:function(a){var b;return b=!a&&(!!document.referrer&&new URL(document.referrer))},updateSession:function(){var a=this,b={source:"(direct)",medium:"(none)"};Object.keys(this.config.fieldMap.last).forEach(function(c){["source","medium"].includes(c)||(b[c]=a.config.nullValue)});var c=this.parseParameters(),d=c.hasOwnProperty("source")&&c.hasOwnProperty("medium")?{}:this.parseReferrer();Object.assign(b,d,c),this.session.first?b=this.session.last&&"(direct)"===b.source?this.session.last:b:(this.session.first=b,this.setCookie(this.config.cookieNames.first,b,400,"days")),this.session.last=b,this.setCookie(this.config.cookieNames.last,b,this.config.sessionTimeout)}};