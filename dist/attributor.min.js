/*! 
 * attributor v2.0
 * 
 * 
 * Copyright (c) 2018 Derek Cavaliero @ WebMechanix
 * 
 * Date: 2022-11-08 17:49:08 PST 
 */
window.Attributor=function(a){if(JSON.parse&&JSON.stringify){var b=this,c={cookieDomain:location.hostname,fieldTargetMethod:"name",fieldMap:{first:{source:"utm_source_1st",medium:"utm_medium_1st",campaign:"utm_campaign_1st",term:"utm_term_1st",content:"utm_content_1st",source_platform:"utm_source_platform_1st",marketing_tactic:"utm_marketing_tactic_1st",creative_format:"utm_creative_format_1st",adgroup:"utm_adgroup_1st",lp:"lp_1st",date:"date_1st"},last:{source:"utm_source",medium:"utm_medium",campaign:"utm_campaign",term:"utm_term",content:"utm_content",source_platform:"utm_source_platform",marketing_tactic:"utm_marketing_tactic",creative_format:"utm_creative_format",adgroup:"utm_adgroup",lp:"lp_last",date:"date_last"},cookies:{_fbc:"fbc",_fbp:"fbp",_ga:"ga",_gcl_aw:"gclid",_uetmsclkid:"msclkid",li_fat_id:"li_fat_id",ttclid:"ttclid"},globals:{"navigator.userAgent":"user_agent","location.href":"conversion_url","document.referrer":"referrer"}},filters:{_ga:function(a){return a.split(".").slice(2).join(".")},_gcl_aw:function(a){return a.split(".").slice(2).join(".")},_uetmsclkid:function(a){return a.slice(4)}}};this.config=this.merge(c,a),this.fieldMap=this.config.fieldMap,this.referrer=this.objectifyUrl(document.referrer),this.params=this.getUrlParams(),this.updateAttrCookies(),this.fillFormFields(),document.addEventListener("click",function(a){a.target.matches('input[type="submit"], button[type="submit"]')&&b.fillFormFields()})}},Attributor.prototype={merge:function(a,b){for(var c in b)b.hasOwnProperty(c)&&b[c]instanceof Object&&Object.assign(b[c],this.merge(a[c],b[c]));return Object.assign(a||{},b),a},objectifyUrl:function(a){var b=document.createElement("a");return b.href=a,{hostname:b.hostname,href:b.href,params:this.getUrlParams(b.href)}},formatDate:function(){var a=new Date,b=a.getDate(),c=a.getMonth()+1;c=c<10?"0"+c:c;var d=a.getFullYear();return d+"-"+c+"-"+b},fillFormFields:function(a){var a="undefined"!=typeof a?a:this.config.fieldTargetMethod,b={_params:this.params,first:this.getCookie("attr_first"),last:this.getCookie("attr_last"),cookies:this.getCookieValues(),globals:this.getGlobalValues()};for(var c in this.fieldMap)if(this.fieldMap.hasOwnProperty(c))for(var d in this.fieldMap[c])if(this.fieldMap[c].hasOwnProperty(d)){var e;switch(a){case"class":e=document.querySelectorAll("input."+this.fieldMap[c][d]);break;case"parentClass":e=document.querySelectorAll("."+this.fieldMap[c][d]+" input");break;case"name":default:e=document.getElementsByName(this.fieldMap[c][d])}if(e)for(var f=0;f<e.length;f++)b[c].hasOwnProperty(d)&&""!=b[c][d]&&(e[f].value=b[c][d])}},updateAttrCookies:function(){var a={source:"(direct)",medium:"(none)",campaign:"(not set)",term:"(not provided)",content:"(not set)",source_platform:"(not set)",marketing_tactic:"(not set)",creative_format:"(not set)",adgroup:"",lp:window.location.hostname+window.location.pathname,date:this.formatDate(),timestamp:Date.now()},b={organic:["www.google.com","www.bing.com","www.yahoo.com","www.ask.com","search.aol.com","www.baidu.com","www.wolframalpha.com","duckduckgo.com","www.yandex.com"],social:["www.linkedin.com","www.facebook.com","t.co","l.instagram.com"]};if(document.referrer&&this.referrer.hostname.indexOf(this.cookieDomain)===-1){var c=!1,d=!1;for(var e in b){if(c)break;if(b.hasOwnProperty(e))for(var f=0;f<b[e].length;f++)if(this.referrer.hostname.indexOf(b[e][f])>-1){var g=b[e][f].split(".");c=2==g.length?g[0]:g[1],d=e;break}}a.source=c?c:this.referrer.hostname,a.medium=d?d:"referral"}for(var h=["source","medium","campaign","term","content","source_platform","marketing_tactic","creative_format","adgroup"],i=!(!this.params.utm_source&&!this.params.utm_medium),f=0;f<h.length;f++)this.params["utm_"+h[f]]&&(a[h[f]]=this.params["utm_"+h[f]]);if(this.params.utm_source||this.params.utm_medium||((this.params.gclid||this.params.fbclid)&&(a.medium="cpc",i=!0),this.params.gclid&&(a.source="google"),this.params.fbclid&&(a.source="facebook")),this.checkCookie("attr_first")){var j=!!this.checkCookie("attr_last")&&this.getCookie("attr_last");!j||i?this.setCookie("attr_last",a,30):this.setCookie("attr_last",j,30)}else this.setCookie("attr_first",a,730,"days"),this.setCookie("attr_last",a,30)},checkCookie:function(a){return a=this.getCookie(a),null!=a&&""!=a},getCookie:function(a,b){if(b="undefined"==typeof b||b,document.cookie.length>0){var c=document.cookie.indexOf(a+"=");if(c!=-1){c=c+a.length+1;var d=document.cookie.indexOf(";",c);d==-1&&(d=document.cookie.length);var e=document.cookie.substring(c,d);return b?JSON.parse(decodeURIComponent(e)):e}}return""},setCookie:function(a,b,c,d){d="undefined"!=typeof d?d:"minutes";var e=new Date;"days"==d&&e.setDate(e.getDate()+c),"minutes"==d&&e.setTime(e.getTime()+60*c*1e3),document.cookie=a+"="+encodeURIComponent(JSON.stringify(b))+(null==c?"":"; domain=."+this.config.cookieDomain+"; expires="+e.toUTCString())+"; path=/"},getCookieValues:function(){var a={};for(var b in this.fieldMap.cookies)this.fieldMap.cookies.hasOwnProperty(b)&&(a[b]=this.config.filters[b]?this.config.filters[b](this.getCookie(b,!1)):this.getCookie(b,!1));return a},getGlobalValues:function(){var a={};for(var b in this.fieldMap.globals)if(this.fieldMap.globals.hasOwnProperty(b)){var c=b.split(".");try{a[b]=window[c[0]][c[1]]}catch(d){}}return a},getUrlParams:function(a){var b={},c=document.createElement("a");if(c.href=a||window.location.href,!c.search)return!1;for(var d=c.search.substring(1),e=d.split("&"),f=0;f<e.length;f++){var g=e[f].split("=");b[g[0]]=decodeURIComponent(g[1])}return b}};