/*! 
 * attributor.js v2.0 
 * https://github.com/derekcavaliero/attributor
 * Â© 2018-2024 Derek Cavaliero @ WebMechanix
 * Updated: 2024-01-30 06:05:24 PST 
 */
Attributor=function(a){var b={cookieDomain:location.hostname,cookieNames:{first:"attr_first",last:"attr_last"},decorateHostnames:[],enableSpaSupport:!1,fieldMap:{first:{source:"utm_source_1st",medium:"utm_medium_1st",campaign:"utm_campaign_1st",term:"utm_term_1st",content:"utm_content_1st",source_platform:"utm_source_platform_1st",marketing_tactic:"utm_marketing_tactic_1st",creative_format:"utm_creative_format_1st",adgroup:"utm_adgroup_1st",id:"utm_id_1st"},last:{source:"utm_source",medium:"utm_medium",campaign:"utm_campaign",term:"utm_term",content:"utm_content",source_platform:"utm_source_platform",marketing_tactic:"utm_marketing_tactic",creative_format:"utm_creative_format",adgroup:"utm_adgroup",id:"utm_id"},cookies:null,globals:null},fieldTargetMethod:"name",filters:{"location.href":function(a){return a.split("?")[0]},"document.referrer":function(a){return a.split("?")[0]}},nullValue:"(not set)",sessionTimeout:30};this.config=this.deepMerge(b,a),this.referrer=this.setReferrer(),this.parameters=this.setParameters(),this.session={first:this.getCookie(this.config.cookieNames.first)||!1,last:this.getCookie(this.config.cookieNames.last)||!1},this.updateSession(),this.fillFormFields(),this.setEventListeners()},Attributor.prototype={deepMerge:function(a,b){for(var c in b)b.hasOwnProperty(c)&&b[c]instanceof Object&&Object.assign(b[c],this.deepMerge(a[c],b[c]));return Object.assign(a||{},b),a},grab:function(a){var a="undefined"!=typeof a?a:"all",b={cookies:this.getCookieValues(),globals:this.getGlobalValues()};for(var c in this.config.fieldMap)if(this.config.fieldMap.hasOwnProperty(c)&&b.hasOwnProperty(c))for(var d in this.config.fieldMap[c])this.config.fieldMap[c].hasOwnProperty(d)&&(b[c][d]&&b[c][d]!=this.config.nullValue&&(b[c][this.config.fieldMap[c][d]]=b[c][d]),delete b[c][d]);var e={};return"all"==a?e=this.session:["first","last"].indexOf(a)>-1&&(e=this.session[a]),Object.assign({session:e},b.cookies,b.globals)},fillFormFields:function(a){var a="object"==typeof a?a:{},b={targetMethod:a.targetMethod||this.config.fieldTargetMethod,scope:a.scope||document},c={_params:this.params,first:this.session.first,last:this.session.last,cookies:this.getCookieValues(),globals:this.getGlobalValues()};for(var d in this.config.fieldMap)if(this.config.fieldMap.hasOwnProperty(d))for(var e in this.config.fieldMap[d])if(this.config.fieldMap[d].hasOwnProperty(e)){var f,g=this.config.fieldMap[d][e];switch(b.targetMethod){case"class":f=b.scope.querySelectorAll("input."+g);break;case"parentClass":f=b.scope.querySelectorAll("."+g+" input");break;case"name":default:f=b.scope.querySelectorAll('input[name="'+g+'"]')}if(f)for(var h=0;h<f.length;h++)c[d].hasOwnProperty(e)&&""!=c[d][e]&&(f[h].value=c[d][e],f[h].dispatchEvent(new Event("input",{bubbles:!0})))}},getCookie:function(a,b){var b="undefined"==typeof b||b,c="";if(document.cookie.length>0){var d=document.cookie.indexOf(a+"=");if(d!=-1){d=d+a.length+1;var e=document.cookie.indexOf(";",d);e==-1&&(e=document.cookie.length),c=document.cookie.substring(d,e),b&&(c=JSON.parse(decodeURIComponent(c)))}}return c},getCookieValues:function(){var a={};for(var b in this.config.fieldMap.cookies)this.config.fieldMap.cookies.hasOwnProperty(b)&&(a[b]="function"==typeof this.config.filters[b]?this.config.filters[b](this.getCookie(b,!1)):this.getCookie(b,!1));return a},getGlobalValues:function(){var a={};for(var b in this.config.fieldMap.globals)if(this.config.fieldMap.globals.hasOwnProperty(b))try{a[b]="function"==typeof this.config.filters[b]?this.config.filters[b](this.resolve(b)):this.resolve(b)}catch(c){}return a},monkeyPatchHistory:function(){var a=history.pushState;history.pushState=function(b){return"function"==typeof history.onpushstate&&history.onpushstate({state:b}),a.apply(history,arguments)}},parseParameters:function(){var a=this,b={};if(!this.parameters)return b;if(["source","medium","campaign","term","content","source_platform","marketing_tactic","creative_format","adgroup","id"].forEach(function(c){var d="utm_"+c;a.parameters.has(d)&&(b[c]=a.parameters.get(d))}),!this.parameters.has("utm_source")&&!this.parameters.has("utm_medium")){var c={google:["gclid","gclsrc","dclid","wbraid","gad_source"],facebook:"fbclid",bing:"msclkid",linkedin:"li_fat_id",tiktok:"ttclid",twitter:"twclid"},d=!1;for(var e in c)if(c.hasOwnProperty(e)){var f=c[e];if(Array.isArray(f)){for(var g=0;g<f.length;g++)if(this.parameters.has(f[g])){d=!0;break}}else this.parameters.has(f)&&(d=!0);if(d){b.source=e,b.medium="cpc";break}}}return b},parseReferrer:function(a){var b=a?new URL(a):this.referrer,c={};if(!b||b.hostname.indexOf(this.config.cookieDomain)>-1)return c;c={source:b.hostname,medium:"referral"};var d={organic:{google:"^www.(google).[a-z]{2,3}(?:.[a-z]{2})?$",bing:"^www.(bing).com$",duckduckgo:"^(duckduckgo).com$",yahoo:"^(?:www|m)?.?(yahoo).(?:com|cn)$",ecosia:"^www.(ecosia).org$",ask:"^www.(ask).com$",aol:"^(?:search.)?(aol).com$",baidu:"^www.(baidu).com$",xfinity:"^my|search.(xfinity).com",yandex:"^(?:www.)?(yandex).com|ru$",lycos:"^(?:www|search)?.?(lycos).[a-z]{2,3}(?:.[a-z]{2})?$"},social:{linkedin:"^www.(linkedin).com$",facebook:"^www.(facebook).com$",twitter:"^t.co$",instagram:"^l.(instagram).com$"}};for(var e in d)if(d.hasOwnProperty(e)){for(var f in d[e])if(d[e].hasOwnProperty(f)){var g=b.hostname.match(d[e][f]);if(g){c.source=f,c.medium=e;break}}if(Object.keys(d).indexOf(c.medium)>-1)break}return c},resolve:function(a){return a.split(".").reduce(function(a,b){return a?a[b]:null},window)},setCookie:function(a,b,c,d){var d="undefined"!=typeof d?d:"minutes",e=new Date;"days"==d&&e.setDate(e.getDate()+c),"minutes"==d&&e.setTime(e.getTime()+60*c*1e3),document.cookie=a+"="+encodeURIComponent(JSON.stringify(b))+(null==c?"":"; domain=."+this.config.cookieDomain+"; expires="+e.toUTCString())+"; path=/"},setEventListeners:function(){function a(a){a.target.matches('[type="submit"]')&&c.fillFormFields({scope:a.target.form||a.target.closest("form")})}function b(a){if(a.target.matches("a")&&a.target.href){var b=new URL(a.target.href);c.config.decorateHostnames.indexOf(b.hostname)!==-1&&(["source","medium","campaign","term","content","id"].forEach(function(a){b.searchParams.set("utm_"+a,c.session.last[a])}),a.target.href=b.toString())}}var c=this;if(this.config.enableSpaSupport){this.monkeyPatchHistory();var d=function(a){c.setReferrer(!0),c.updateSession()};window.addEventListener("popstate",d),window.onpopstate=history.onpushstate=d}document.addEventListener("click",a),document.addEventListener("click",b)},setParameters:function(){var a=new URL(location.href);return!!a.search&&a.searchParams},setReferrer:function(a){var b;return b=!a&&(!!document.referrer&&new URL(document.referrer))},updateSession:function(){var a={source:"(direct)",medium:"(none)",campaign:this.config.nullValue,term:this.config.nullValue,content:this.config.nullValue,source_platform:this.config.nullValue,marketing_tactic:this.config.nullValue,creative_format:this.config.nullValue,adgroup:this.config.nullValue,id:this.config.nullValue},b=this.parseParameters(),c=b.hasOwnProperty("source")&&b.hasOwnProperty("medium")?{}:this.parseReferrer();Object.assign(a,c,b),this.session.first?a=this.session.last&&"(direct)"===a.source?this.session.last:a:(this.session.first=a,this.setCookie(this.config.cookieNames.first,a,400,"days")),this.session.last=a,this.setCookie(this.config.cookieNames.last,a,this.config.sessionTimeout)}};